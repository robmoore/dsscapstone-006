document.write('<link rel="stylesheet" href="gist/gist-server-R.css">')
document.write('<div class=\"gist\"><div class=\"gist-file\"><div class=\"gist-data gist-syntax\"><div class=\"file-data\"><table cellpadding=\"0\" cellspacing=\"0\" class=\"lines highlight\"><tr><td class=\"line-numbers\"><span class=\"line-number\" id=\"file-server-r-L1\" rel=\"file-server-r-L1\">1<\/span><span class=\"line-number\" id=\"file-server-r-L2\" rel=\"file-server-r-L2\">2<\/span><span class=\"line-number\" id=\"file-server-r-L3\" rel=\"file-server-r-L3\">3<\/span><span class=\"line-number\" id=\"file-server-r-L4\" rel=\"file-server-r-L4\">4<\/span><span class=\"line-number\" id=\"file-server-r-L5\" rel=\"file-server-r-L5\">5<\/span><span class=\"line-number\" id=\"file-server-r-L6\" rel=\"file-server-r-L6\">6<\/span><span class=\"line-number\" id=\"file-server-r-L7\" rel=\"file-server-r-L7\">7<\/span><span class=\"line-number\" id=\"file-server-r-L8\" rel=\"file-server-r-L8\">8<\/span><span class=\"line-number\" id=\"file-server-r-L9\" rel=\"file-server-r-L9\">9<\/span><span class=\"line-number\" id=\"file-server-r-L10\" rel=\"file-server-r-L10\">10<\/span><span class=\"line-number\" id=\"file-server-r-L11\" rel=\"file-server-r-L11\">11<\/span><span class=\"line-number\" id=\"file-server-r-L12\" rel=\"file-server-r-L12\">12<\/span><span class=\"line-number\" id=\"file-server-r-L13\" rel=\"file-server-r-L13\">13<\/span><span class=\"line-number\" id=\"file-server-r-L14\" rel=\"file-server-r-L14\">14<\/span><span class=\"line-number\" id=\"file-server-r-L15\" rel=\"file-server-r-L15\">15<\/span><span class=\"line-number\" id=\"file-server-r-L16\" rel=\"file-server-r-L16\">16<\/span><span class=\"line-number\" id=\"file-server-r-L17\" rel=\"file-server-r-L17\">17<\/span><span class=\"line-number\" id=\"file-server-r-L18\" rel=\"file-server-r-L18\">18<\/span><span class=\"line-number\" id=\"file-server-r-L19\" rel=\"file-server-r-L19\">19<\/span><span class=\"line-number\" id=\"file-server-r-L20\" rel=\"file-server-r-L20\">20<\/span><span class=\"line-number\" id=\"file-server-r-L21\" rel=\"file-server-r-L21\">21<\/span><span class=\"line-number\" id=\"file-server-r-L22\" rel=\"file-server-r-L22\">22<\/span><span class=\"line-number\" id=\"file-server-r-L23\" rel=\"file-server-r-L23\">23<\/span><span class=\"line-number\" id=\"file-server-r-L24\" rel=\"file-server-r-L24\">24<\/span><span class=\"line-number\" id=\"file-server-r-L25\" rel=\"file-server-r-L25\">25<\/span><span class=\"line-number\" id=\"file-server-r-L26\" rel=\"file-server-r-L26\">26<\/span><span class=\"line-number\" id=\"file-server-r-L27\" rel=\"file-server-r-L27\">27<\/span><span class=\"line-number\" id=\"file-server-r-L28\" rel=\"file-server-r-L28\">28<\/span><span class=\"line-number\" id=\"file-server-r-L29\" rel=\"file-server-r-L29\">29<\/span><span class=\"line-number\" id=\"file-server-r-L30\" rel=\"file-server-r-L30\">30<\/span><span class=\"line-number\" id=\"file-server-r-L31\" rel=\"file-server-r-L31\">31<\/span><span class=\"line-number\" id=\"file-server-r-L32\" rel=\"file-server-r-L32\">32<\/span><span class=\"line-number\" id=\"file-server-r-L33\" rel=\"file-server-r-L33\">33<\/span><span class=\"line-number\" id=\"file-server-r-L34\" rel=\"file-server-r-L34\">34<\/span><span class=\"line-number\" id=\"file-server-r-L35\" rel=\"file-server-r-L35\">35<\/span><span class=\"line-number\" id=\"file-server-r-L36\" rel=\"file-server-r-L36\">36<\/span><span class=\"line-number\" id=\"file-server-r-L37\" rel=\"file-server-r-L37\">37<\/span><span class=\"line-number\" id=\"file-server-r-L38\" rel=\"file-server-r-L38\">38<\/span><span class=\"line-number\" id=\"file-server-r-L39\" rel=\"file-server-r-L39\">39<\/span><span class=\"line-number\" id=\"file-server-r-L40\" rel=\"file-server-r-L40\">40<\/span><span class=\"line-number\" id=\"file-server-r-L41\" rel=\"file-server-r-L41\">41<\/span><span class=\"line-number\" id=\"file-server-r-L42\" rel=\"file-server-r-L42\">42<\/span><span class=\"line-number\" id=\"file-server-r-L43\" rel=\"file-server-r-L43\">43<\/span><span class=\"line-number\" id=\"file-server-r-L44\" rel=\"file-server-r-L44\">44<\/span><span class=\"line-number\" id=\"file-server-r-L45\" rel=\"file-server-r-L45\">45<\/span><span class=\"line-number\" id=\"file-server-r-L46\" rel=\"file-server-r-L46\">46<\/span><span class=\"line-number\" id=\"file-server-r-L47\" rel=\"file-server-r-L47\">47<\/span><span class=\"line-number\" id=\"file-server-r-L48\" rel=\"file-server-r-L48\">48<\/span><span class=\"line-number\" id=\"file-server-r-L49\" rel=\"file-server-r-L49\">49<\/span><span class=\"line-number\" id=\"file-server-r-L50\" rel=\"file-server-r-L50\">50<\/span><span class=\"line-number\" id=\"file-server-r-L51\" rel=\"file-server-r-L51\">51<\/span><span class=\"line-number\" id=\"file-server-r-L52\" rel=\"file-server-r-L52\">52<\/span><span class=\"line-number\" id=\"file-server-r-L53\" rel=\"file-server-r-L53\">53<\/span><span class=\"line-number\" id=\"file-server-r-L54\" rel=\"file-server-r-L54\">54<\/span><span class=\"line-number\" id=\"file-server-r-L55\" rel=\"file-server-r-L55\">55<\/span><span class=\"line-number\" id=\"file-server-r-L56\" rel=\"file-server-r-L56\">56<\/span><span class=\"line-number\" id=\"file-server-r-L57\" rel=\"file-server-r-L57\">57<\/span><span class=\"line-number\" id=\"file-server-r-L58\" rel=\"file-server-r-L58\">58<\/span><span class=\"line-number\" id=\"file-server-r-L59\" rel=\"file-server-r-L59\">59<\/span><span class=\"line-number\" id=\"file-server-r-L60\" rel=\"file-server-r-L60\">60<\/span><\/td><td class=\"line-data\"><pre class=\"line-pre\"><div class=\"line\" id=\"file-server-r-LC1\">library(<span class=\"pl-vo\">shiny<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC2\">library(<span class=\"pl-vo\">stringi<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC3\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC4\"><span class=\"pl-en\">section.1<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">phrase<\/span>) {<\/div><div class=\"line\" id=\"file-server-r-LC5\">    <span class=\"pl-st\">data.frame<\/span>(<span class=\"pl-v\">suggestion<\/span> <span class=\"pl-k\">=<\/span> c(<span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>a<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>b<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>c<span class=\"pl-pds\">&#39;<\/span><\/span>),<\/div><div class=\"line\" id=\"file-server-r-LC6\">        <span class=\"pl-v\">score<\/span> <span class=\"pl-k\">=<\/span> c(<span class=\"pl-c1\">30<\/span>, <span class=\"pl-c1\">20<\/span>, <span class=\"pl-c1\">10<\/span>))<\/div><div class=\"line\" id=\"file-server-r-LC7\">}<\/div><div class=\"line\" id=\"file-server-r-LC8\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC9\"><span class=\"pl-en\">section.2<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">phrase<\/span>) {<\/div><div class=\"line\" id=\"file-server-r-LC10\">    <span class=\"pl-st\">data.frame<\/span>(<span class=\"pl-v\">suggestion<\/span> <span class=\"pl-k\">=<\/span> c(<span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>i<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>j<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>k<span class=\"pl-pds\">&#39;<\/span><\/span>),<\/div><div class=\"line\" id=\"file-server-r-LC11\">        <span class=\"pl-v\">score<\/span> <span class=\"pl-k\">=<\/span> c(<span class=\"pl-c1\">100<\/span>, <span class=\"pl-c1\">50<\/span>, <span class=\"pl-c1\">25<\/span>))<\/div><div class=\"line\" id=\"file-server-r-LC12\">}<\/div><div class=\"line\" id=\"file-server-r-LC13\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC14\"><span class=\"pl-en\">section.3<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">phrase<\/span>) {<\/div><div class=\"line\" id=\"file-server-r-LC15\">    <span class=\"pl-st\">data.frame<\/span>(<span class=\"pl-v\">suggestion<\/span> <span class=\"pl-k\">=<\/span> c(<span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>x<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>y<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>z<span class=\"pl-pds\">&#39;<\/span><\/span>),<\/div><div class=\"line\" id=\"file-server-r-LC16\">            <span class=\"pl-v\">score<\/span> <span class=\"pl-k\">=<\/span> c(<span class=\"pl-c1\">99<\/span>, <span class=\"pl-c1\">66<\/span>, <span class=\"pl-c1\">33<\/span>))<\/div><div class=\"line\" id=\"file-server-r-LC17\">}<\/div><div class=\"line\" id=\"file-server-r-LC18\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC19\"><span class=\"pl-en\">suggestions<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">phrase<\/span>) {<\/div><div class=\"line\" id=\"file-server-r-LC20\">    <span class=\"pl-k\">if<\/span> (is.null(<span class=\"pl-vo\">phrase<\/span>) <span class=\"pl-k\">||<\/span> (stri_isempty(<span class=\"pl-vo\">phrase<\/span>))) {<\/div><div class=\"line\" id=\"file-server-r-LC21\">        <span class=\"pl-k\">return<\/span> (<span class=\"pl-c1\">NULL<\/span>);<\/div><div class=\"line\" id=\"file-server-r-LC22\">    }<\/div><div class=\"line\" id=\"file-server-r-LC23\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC24\">    <span class=\"pl-vo\">section.1<\/span> <span class=\"pl-k\">&lt;-<\/span> apply(section.1(<span class=\"pl-vo\">phrase<\/span>), <span class=\"pl-c1\">1<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC25\">        <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">entry<\/span>) {<span class=\"pl-st\">list<\/span>(<span class=\"pl-v\">suggestion<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">entry<\/span>[[<span class=\"pl-c1\">1<\/span>]], <span class=\"pl-v\">score<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">entry<\/span>[[<span class=\"pl-c1\">2<\/span>]])})<\/div><div class=\"line\" id=\"file-server-r-LC26\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC27\">    <span class=\"pl-vo\">section.2<\/span> <span class=\"pl-k\">&lt;-<\/span> apply(section.2(<span class=\"pl-vo\">phrase<\/span>), <span class=\"pl-c1\">1<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC28\">        <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">entry<\/span>) {<span class=\"pl-st\">list<\/span>(<span class=\"pl-v\">suggestion<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">entry<\/span>[[<span class=\"pl-c1\">1<\/span>]], <span class=\"pl-v\">score<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">entry<\/span>[[<span class=\"pl-c1\">2<\/span>]])})<\/div><div class=\"line\" id=\"file-server-r-LC29\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC30\">    <span class=\"pl-vo\">section.3<\/span> <span class=\"pl-k\">&lt;-<\/span> apply(section.3(<span class=\"pl-vo\">phrase<\/span>), <span class=\"pl-c1\">1<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC31\">        <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">entry<\/span>) {<span class=\"pl-st\">list<\/span>(<span class=\"pl-v\">suggestion<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">entry<\/span>[[<span class=\"pl-c1\">1<\/span>]], <span class=\"pl-v\">score<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">entry<\/span>[[<span class=\"pl-c1\">2<\/span>]])})<\/div><div class=\"line\" id=\"file-server-r-LC32\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC33\">    <span class=\"pl-st\">list<\/span>(<span class=\"pl-v\">phrase<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">phrase<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC34\">        <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>section-1-id<span class=\"pl-pds\">&#39;<\/span><\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">section.1<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC35\">        <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>section-2-id<span class=\"pl-pds\">&#39;<\/span><\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">section.2<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC36\">        <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>section-3-id<span class=\"pl-pds\">&#39;<\/span><\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">section.3<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC37\">}<\/div><div class=\"line\" id=\"file-server-r-LC38\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC39\"><span class=\"pl-en\">updateTypeaheadSuggestions<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">session<\/span>, <span class=\"pl-vo\">id<\/span>, <span class=\"pl-vo\">suggestions<\/span>) {<\/div><div class=\"line\" id=\"file-server-r-LC40\">    <span class=\"pl-vo\">message<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-st\">list<\/span>(<span class=\"pl-v\">id<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">id<\/span>,<\/div><div class=\"line\" id=\"file-server-r-LC41\">        <span class=\"pl-v\">suggestions<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">suggestions<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC42\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC43\">    <span class=\"pl-vo\">session<\/span><span class=\"pl-k\">$<\/span>sendCustomMessage(<span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>typeahead.jsUpdateSuggestions<span class=\"pl-pds\">&#39;<\/span><\/span>, <span class=\"pl-vo\">message<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC44\">}<\/div><div class=\"line\" id=\"file-server-r-LC45\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC46\">shinyServer(<span class=\"pl-k\">function<\/span>(<span class=\"pl-vo\">input<\/span>, <span class=\"pl-vo\">output<\/span>, <span class=\"pl-vo\">session<\/span>) {<\/div><div class=\"line\" id=\"file-server-r-LC47\">    <span class=\"pl-vo\">data<\/span> <span class=\"pl-k\">&lt;-<\/span> reactive({<\/div><div class=\"line\" id=\"file-server-r-LC48\">        <span class=\"pl-vo\">phrase<\/span> <span class=\"pl-k\">&lt;-<\/span> <span class=\"pl-vo\">input<\/span><span class=\"pl-k\">$<\/span><span class=\"pl-vo\">q<\/span><\/div><div class=\"line\" id=\"file-server-r-LC49\">        <span class=\"pl-vo\">suggestions<\/span> <span class=\"pl-k\">&lt;-<\/span> suggestions(<span class=\"pl-vo\">phrase<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC50\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC51\">        <span class=\"pl-st\">list<\/span>(<span class=\"pl-v\">suggestions<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">suggestions<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC52\">    })<\/div><div class=\"line\" id=\"file-server-r-LC53\">&nbsp;<\/div><div class=\"line\" id=\"file-server-r-LC54\">    observe({<\/div><div class=\"line\" id=\"file-server-r-LC55\">        <span class=\"pl-k\">if<\/span> (is.null(data()) <span class=\"pl-k\">||<\/span> is.null(data()<span class=\"pl-k\">$<\/span><span class=\"pl-vo\">suggestions<\/span>)) {<\/div><div class=\"line\" id=\"file-server-r-LC56\">            <span class=\"pl-k\">return<\/span><\/div><div class=\"line\" id=\"file-server-r-LC57\">        }<\/div><div class=\"line\" id=\"file-server-r-LC58\">        updateTypeaheadSuggestions(<span class=\"pl-vo\">session<\/span>, <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>q<span class=\"pl-pds\">&#39;<\/span><\/span>, data()<span class=\"pl-k\">$<\/span><span class=\"pl-vo\">suggestions<\/span>)<\/div><div class=\"line\" id=\"file-server-r-LC59\">    })<\/div><div class=\"line\" id=\"file-server-r-LC60\">})<\/div><\/pre><\/td><\/tr><\/table><\/div><\/div><div class=\"gist-meta\">server.R<\/div><\/div><\/div>')
